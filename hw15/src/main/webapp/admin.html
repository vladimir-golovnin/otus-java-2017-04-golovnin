<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Manage Users</title>
    <script>
        var ws = new WebSocket("ws://localhost:8080/socket");

ws.onopen = function(){
    document.getElementById("status").innerHTML = "<p>Open</p>";
};

ws.onmessage = function (evt){
    var message = JSON.parse(evt.data);
    var usersData = "";
    message.forEach(function(entry){
            usersData += entry.name;
        });
    document.getElementById("data").innerHTML = usersData;
};

ws.onclose = function(evt){
    document.getElementById("status").innerHTML = "<p>Connection to server is lost!</p>";
};
ws.onerror = function(error){
    document.getElementById("status").innerHTML = "<p>Error</p>";
};

function addUser(){
    var name = document.getElementById("name").value;
    var age = document.getElementById("age").value;
    if(name != "" && age != ""){
        var userAction = {
            action: 1,
            user: { id: 0, name: name, age: age}
        };
        ws.send(JSON.stringify(userAction));
    }
};

function removeUser(){
    var id = document.getElementById("identificator").value;
    if(!isNaN(id)){
        var userAction = {
            action: 2,
            user: { id: id, name: "", age: 0}
        };
        ws.send(JSON.stringify(userAction));
    }
};
    </script>
</head>
<body>
<form>
    <p>name:<input type="text" id="name" autocomplete="off"></p>
    <p>age:<input type="text" id="age" autocomplete="off"></p>
    <input type="button" value="add" onclick=addUser()>
</form>
<form>
    <p>id:<input type="text" id="identificator" autocomplete="off"></p>
    <input type="button" value="remove" onclick=removeUser()>
</form>
<div id="data"></div>
<div id="status"></div>
</body>
</html>
